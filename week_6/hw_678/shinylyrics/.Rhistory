wordcloud2(tabledata)
tabledata <-table(cc[clean])
clean <- gsub('??, '', clean)
clean <- gsub('æ¯?, '', clean)
clean <- gsub('ä¸€', '', clean)
clean <- gsub('å¤?, '', clean)
clean <- gsub('ä¸?, '', clean)
clean <- gsub('äº?, '', clean)
clean <- gsub('? æ²¹', '', clean)
clean <- gsub('ä»€éº?, '', clean)
cc[clean]
tabledata <-table(cc[clean])
#Show wordcloud
#install.packages('wordcloud2')
#library(wordcloud2)
wordcloud2(tabledata)
#tabledata
help(data.frame)
#tabledata
help("order")
#tabledata
help("ordered")
ordered(data.frame(tabledata)$freq)
order(data.frame(tabledata)$freq)
order(data.frame(tabledata))
ordered(data.frame(tabledata))
tabledata
#Show wordcloud
#install.packages('wordcloud2')
#library(wordcloud2)
wordcloud2(tabledata)
q()
attach(iris)
plot(Sepal.Length[Species=="setosa"],Petal.Length[Species=="setosa"],?‚pch=1??col="black",?‚xlim=c(4,8),?‚ylim= c(0,8),?‚main="classified scatter plot",?‚xlab=??SLen",?‚ylab=??PLen")
attach(iris)
plot(Sepal.Length[Species=="setosa"],Petal.Length[Species=="setosa"],
pch=1 ,col="black", xlim=c(4,8), ylim= c(0,8), main="classified scatter plot",
xlab="SLen", ylab="PLen")
plot(Sepal.Length[Species=="setosa"],Petal.Length[Species=="setosa"])
plot(Sepal.Length[Species=="setosa"],Petal.Length[Species=="setosa"],
pch=1 ,col="black", xlim=c(4,8), ylim= c(0,8), main="classified scatter plot",
xlab="SLen", ylab="PLen")
points(Sepal.Length[Species=="virginica"], Petal.Length[Species== "virginica"],pch=3,col="green")
points(Sepal.Length[Species=="versicolor"], Petal.Length[Species== "versicolor"],pch=2,col="red")
legend(4,8,legend=c("setosa","versicolor","virginica"),?‚col=c(1,2,3), pch=c(1,2,3))
legend(4,8,legend=c("setosa","versicolor","virginica"), col=c(1,2,3), pch=c(1,2,3))
iris
head(iris,5)
mean(iris$Sepal.Length)
round(mean(iris$Sepal.Length),2)
round(mean(Sepal.Length),2)
summary(iris)
plot(Sepal.Length,Sepal.Width)
plot(Species)
plot(Species,Sepal.Length)
plot(iris)
shapiro.test(Sepal.Length)
library(nortest)
install.packages("nortest")
library(nortest)
ad.test(Sepal.Length)
qqnorm(Sepal.Length)
qqline(Sepal.Length,col="red")
hist(Sepal.Length,breaks=seq(4.0,8.0,0.25),prob=TRUE)
curve(dnorm(x,mean(Sepal.Length),sd(Sepal.Length)),4.0,8.0,add=TRUE, col="red")
xtabs(~Species)
setosa=subset(iris,Species=="setosa")
versicolor=subset(iris,Species=="versicolor")
var.test(setosa$Petal.Width,?‚versicolor$Petal.Width)
var.test(setosa$Petal.Width, versicolor$Petal.Width)
t.test(setosa$Petal.Width, versicolor$Petal.Width, var.equal=FALSE)
iris2=subset(iris,Species!="virginica")
var.test(iris2$Petal.Width?‚~?‚iris2$Species)
iris2=subset(iris,Species!="virginica")
var.test(iris2$Petal.Width ~ iris2$Species)
t.test(iris2$Petal.Width ~ iris2$Species,var.equal=FALSE,?‚conf=0.95)
t.test(iris2$Petal.Width ~ iris2$Species,var.equal=FALSE, conf=0.95)
#è¿´æ­¸?†æ?
#model=lm(Y~X1+X2+??Xk,?‚data=??
Sepal.Length = 0.65084xSepal.Width+ 0.70913xPetal.Length- 0.55648xPetal.Width+ 1.85600
#è¿´æ­¸?†æ?
#model=lm(Y~X1+X2+??Xk,?‚data=??
Sepal.Length = 0.65084*Sepal.Width + 0.70913*Petal.Length - 0.55648*Petal.Width + 1.85600
#æ±ºç?æ¨¹è??™æ¢??n=0.1*nrow(iris)
test.index=sample(1:nrow(iris),n)
iris.train=iris[-test.index,]
iris.test=iris[test.index,]
library(tree)
install.packages("tree")
library(tree)
iris.tree=tree(Species~ . ,data=iris.train)
iris.tree
plot(iris.tree)
text(iris.tree)
install.packages("randomForest")
#Random Forest
library(randomForest)
set.seed(777)
iris.rf=randomForest(Species ~ ., data=iris.train,importane=T,proximity=T)
print(iris.rf)
round(importance(iris.rf),2)
names(iris.rf)
(table.rf=iris.rf$confusion)
sum(diag(table.rf)/sum(table.rf))
#predict
(rf.pred=predict(iris.rf,newdata=iris.test))
(table.test=table(Species=species.test,Predicted=rf.pred))
MDSplot(iris.urf,iris$Species,palette=rep(1,3),pch=as.numeric(iris$Species))
(iris.urf=randomForest(iris[,-5]))
MDSplot(iris.urf,iris$Species,palette=rep(1,3),pch=as.numeric(iris$Species))
require(graphics)
# a 2-dimensional example
x <- rbind(matrix(rnorm(100, sd = 0.3), ncol = 2),
matrix(rnorm(100, mean = 1, sd = 0.3), ncol = 2))
colnames(x) <- c("x", "y")
(cl <- kmeans(x, 2))
plot(x, col = cl$cluster)
points(cl$centers, col = 1:2, pch = 8, cex = 2)
rnorm(100, sd = 0.3)
help('rnorm')
matrix(rnorm(100, sd = 0.3), ncol = 2)
colnames(x) <- c("x", "y")
rnorm(100, mean = 1, sd = 0.3), ncol = 2)
# a 2-dimensional example
x <- rbind(matrix(rnorm(100, sd = 0.3), ncol = 2),
matrix(rnorm(100, mean = 1, sd = 0.3), ncol = 2))
rnorm(100, mean = 1, sd = 0.3), ncol = 2))
rnorm(100, mean = 1, sd = 0.3), ncol = 2)
rnorm(100, mean = 1, sd = 0.3), ncol = 2)
rnorm(100, mean = 1, sd = 0.3)
matrix(rnorm(100, mean = 1, sd = 0.3), ncol = 2)
(cl <- kmeans(x, 2))
plot(x, col = cl$cluster)
cl
View(cl)
cl$cluster
cl$centers
points(cl$centers, col = 1:2, pch = 8, cex = 2)
## cluster centers "fitted" to each obs.:
fitted.x <- fitted(cl);  head(fitted.x)
resid.x <- x - fitted(cl)
# sum of squares
ss <- function(x) sum(scale(x, scale = FALSE)^2)
## cluster centers "fitted" to each obs.:
fitted.x <- fitted(cl);  head(fitted.x)
resid.x <- x - fitted(cl)
## Equalities : ----------------------------------
cbind(cl[c("betweenss", "tot.withinss", "totss")], # the same two columns
c(ss(fitted.x), ss(resid.x),    ss(x)))
stopifnot(all.equal(cl$ totss,        ss(x)),
all.equal(cl$ tot.withinss, ss(resid.x)),
## these three are the same:
all.equal(cl$ betweenss,    ss(fitted.x)),
all.equal(cl$ betweenss, cl$totss - cl$tot.withinss),
## and hence also
all.equal(ss(x), ss(fitted.x) + ss(resid.x))
)
kmeans(x,1)$withinss # trivial one-cluster, (its W.SS == ss(x))
## random starts do help here with too many clusters
## (and are often recommended anyway!):
(cl <- kmeans(x, 5, nstart = 25))
plot(x, col = cl$cluster)
points(cl$centers, col = 1:5, pch = 8)
help('fitted')
resid.x <- x - fitted(cl)
## Equalities : ----------------------------------
cbind(cl[c("betweenss", "tot.withinss", "totss")], # the same two columns
c(ss(fitted.x), ss(resid.x),    ss(x)))
stopifnot(all.equal(cl$ totss,        ss(x)),
all.equal(cl$ tot.withinss, ss(resid.x)),
## these three are the same:
all.equal(cl$ betweenss,    ss(fitted.x)),
all.equal(cl$ betweenss, cl$totss - cl$tot.withinss),
## and hence also
all.equal(ss(x), ss(fitted.x) + ss(resid.x))
)
stopifnot(all.equal(cl$ totss,        ss(x)),
all.equal(cl$ tot.withinss, ss(resid.x)),
## these three are the same:
all.equal(cl$ betweenss,    ss(fitted.x)),
all.equal(cl$ betweenss, cl$totss - cl$tot.withinss),
## and hence also
all.equal(ss(x), ss(fitted.x) + ss(resid.x))
)
kmeans(x,1)$withinss # trivial one-cluster, (its W.SS == ss(x))
require(graphics)
# a 2-dimensional example
x <- rbind(matrix(rnorm(100, sd = 0.3), ncol = 2),
matrix(rnorm(100, mean = 1, sd = 0.3), ncol = 2))
rnorm(100, sd = 0.3)
matrix(rnorm(100, sd = 0.3), ncol = 2)
matrix(rnorm(100, mean = 1, sd = 0.3), ncol = 2)
colnames(x) <- c("x", "y")
(cl <- kmeans(x, 2))
View(cl)
cl$cluster
cl$centers
plot(x, col = cl$cluster)
points(cl$centers, col = 1:2, pch = 8, cex = 2)
# sum of squares
ss <- function(x) sum(scale(x, scale = FALSE)^2)
## cluster centers "fitted" to each obs.:
fitted.x <- fitted(cl);  head(fitted.x)
resid.x <- x - fitted(cl)
## Equalities : ----------------------------------
cbind(cl[c("betweenss", "tot.withinss", "totss")], # the same two columns
c(ss(fitted.x), ss(resid.x),    ss(x)))
stopifnot(all.equal(cl$ totss,        ss(x)),
all.equal(cl$ tot.withinss, ss(resid.x)),
## these three are the same:
all.equal(cl$ betweenss,    ss(fitted.x)),
all.equal(cl$ betweenss, cl$totss - cl$tot.withinss),
## and hence also
all.equal(ss(x), ss(fitted.x) + ss(resid.x))
)
help('stopifnot')
kmeans(x,1)$withinss # trivial one-cluster, (its W.SS == ss(x))
## random starts do help here with too many clusters
## (and are often recommended anyway!):
(cl <- kmeans(x, 5, nstart = 25))
plot(x, col = cl$cluster)
points(cl$centers, col = 1:5, pch = 8)
mtcar
mtcars
summary(mtcars)
str(mtcars)
#Because PCA works best with numerical data, you'll exclude the two categorical variables (vs and am)
mtcars.pca <- prcomp(mtcars[,c(1:7,10,11)], center = TRUE,scale. = TRUE)
mtcars.pca
summary(mtcars.pca)
str(mtcars.pca)
install.packages("vqv/ggbiplot")
library(devtools)
ggbiplot(mtcars.pca)
library(devtools)
install_github("vqv/ggbiplot")
#install_github("vqv/ggbiplot")
library(ggbiplot)
ggbiplot(mtcars.pca)
#Interpret the Results
mtcars.country <- c(rep("Japan", 3), rep("US",4), rep("Europe", 7),rep("US",3), "Europe", rep("Japan", 3), rep("US",4), rep("Europe", 3), "US", rep("Europe", 3))
help('rep')
ggbiplot(mtcars.pca,ellipse=TRUE,  labels=rownames(mtcars), groups=mtcars.country)
#See results using PC3 & PC4
ggbiplot(mtcars.pca,ellipse=TRUE,choices=c(3,4),   labels=rownames(mtcars), groups=mtcars.country)
#Other Options
ggbiplot(mtcars.pca,ellipse=TRUE,obs.scale = 1, var.scale = 1,  labels=rownames(mtcars), groups=mtcars.country)
ggbiplot(mtcars.pca,ellipse=TRUE,obs.scale = 1, var.scale = 1,var.axes=FALSE,   labels=rownames(mtcars), groups=mtcars.country)
#Specify the colours to use for the groups with scale_colour_manual()
#Add a title with ggtitle()
#Specify the minimal() theme
#Move the legend with theme()
ggbiplot(mtcars.pca,ellipse=TRUE,obs.scale = 1, var.scale = 1,  labels=rownames(mtcars), groups=mtcars.country) +
scale_colour_manual(name="Origin", values= c("forest green", "red3", "dark blue"))+
ggtitle("PCA of mtcars dataset")+
theme_minimal()+
theme(legend.position = "bottom")
#Add a new sample
spacecar <- c(1000,60,50,500,0,0.5,2.5,0,1,0,0)
mtcarsplus <- rbind(mtcars, spacecar)
mtcars.countryplus <- c(mtcars.country, "Jupiter")
mtcarsplus.pca <- prcomp(mtcarsplus[,c(1:7,10,11)], center = TRUE,scale. = TRUE)
ggbiplot(mtcarsplus.pca, obs.scale = 1, var.scale = 1, ellipse = TRUE, circle = FALSE, var.axes=TRUE, labels=c(rownames(mtcars), "spacecar"), groups=mtcars.countryplus)+
scale_colour_manual(name="Origin", values= c("forest green", "red3", "violet", "dark blue"))+
ggtitle("PCA of mtcars dataset, with extra sample added")+
theme_minimal()+
theme(legend.position = "bottom")
#Project a new sample onto the original PCA
s.sc <- scale(t(spacecar[c(1:7,10,11)]), center= mtcars.pca$center)
s.pred <- s.sc %*% mtcars.pca$rotation
mtcars.plusproj.pca <- mtcars.pca
mtcars.plusproj.pca$x <- rbind(mtcars.plusproj.pca$x, s.pred)
ggbiplot(mtcars.plusproj.pca, obs.scale = 1, var.scale = 1, ellipse = TRUE, circle = FALSE, var.axes=TRUE, labels=c(rownames(mtcars), "spacecar"), groups=mtcars.countryplus)+
scale_colour_manual(name="Origin", values= c("forest green", "red3", "violet", "dark blue"))+
ggtitle("PCA of mtcars dataset, with extra sample projected")+
theme_minimal()+
theme(legend.position = "bottom")
q()
library(shiny); runApp('D:/CSX_Lyhs/week_6/hw_6~8/shinylyrics/shinylyrics.R')
install.packages("dplyr")
runApp('D:/CSX_Lyhs/week_6/hw_6~8/shinylyrics/shinylyrics.R')
install.packages("stringi")
runApp('D:/CSX_Lyhs/week_6/hw_6~8/shinylyrics/shinylyrics.R')
install.packages("tidyr")
runApp('D:/CSX_Lyhs/week_6/hw_6~8/shinylyrics/shinylyrics.R')
runApp('D:/CSX_Lyhs/week_6/hw_678/shinylyrics/shinylyrics.R')
runApp('D:/CSX_Lyhs/week_6/hw_678/shinylyrics/shinylyrics.R')
library(shiny)
library(bitops)
library(httr)
library(RCurl)
library(XML)
library(tm)
library(NLP)
library(tmcn)
library(jiebaRD)
library(jiebaR)
library(rvest)
library(magrittr)
library(ggplot2)
library(tidytext)
library(stats)
library(proxy)
library(readtext)
library(slam)
library(Matrix)
library(tidyverse)
library(wordcloud)
library(ggbiplot)
library(factoextra)
library(plotly)
library(rsconnect)
runApp('D:/CSX_Lyhs/week_6/hw_678/shinylyrics')
runApp('D:/CSX_Lyhs/week_6/hw_678/shinylyrics')
install.packages(c("plyr", "dplyr", "shiny", "bitops", "httr", "Rcurl", "XML", "tm", "NLP", "tmcn", "jiebaRD", "jiebaR", "rvest", "magrittr", "ggplot2", "tidytext", "stats", "proxy", "readtext", "slam", "Matrix", "tidyverse", "wordcloud", "ggbiplot", "factoextra", "plotly", "rsconnect"))
install.packages(c("plyr", "dplyr", "shiny", "bitops", "httr", "Rcurl", "XML", "tm", "NLP", "tmcn", "jiebaRD", "jiebaR", "rvest", "magrittr", "ggplot2", "tidytext", "stats", "proxy", "readtext", "slam", "Matrix", "tidyverse", "wordcloud", "ggbiplot", "factoextra", "plotly", "rsconnect"))
install.packages(c("plyr", "dplyr", "shiny", "bitops", "httr", "Rcurl", "XML", "tm", "NLP", "tmcn", "jiebaRD", "jiebaR", "rvest", "magrittr", "ggplot2", "tidytext", "stats", "proxy", "readtext", "slam", "Matrix", "tidyverse", "wordcloud", "ggbiplot", "factoextra", "plotly", "rsconnect"))
install.packages(c("plyr", "dplyr", "shiny", "bitops", "httr", "Rcurl", "XML", "tm", "NLP", "tmcn", "jiebaRD", "jiebaR", "rvest", "magrittr", "ggplot2", "tidytext", "stats", "proxy", "readtext", "slam", "Matrix", "tidyverse", "wordcloud", "ggbiplot", "factoextra", "plotly", "rsconnect"))
shiny::runApp('D:/CSX_Lyhs/week_6/hw_678/shinylyrics')
install.packages(c("plyr", "dplyr", "shiny", "bitops", "httr", "Rcurl", "XML", "tm", "NLP", "tmcn", "jiebaRD", "jiebaR", "rvest", "magrittr", "ggplot2", "tidytext", "stats", "proxy", "readtext", "slam", "Matrix", "tidyverse", "wordcloud", "ggbiplot", "factoextra", "plotly", "rsconnect"))
shiny::runApp('D:/CSX_Lyhs/week_6/hw_678/shinylyrics')
runApp('D:/CSX_Lyhs/week_6/hw_678/shinylyrics')
#install.packages(c('plyr','dplyr','shiny','bitops','httr','Rcurl','XML','tm','NLP','tmcn','jiebaRD','jiebaR','rvest', 'magrittr','ggplot2','tidytext','stats', 'proxy', 'readtext','slam','Matrix','tidyverse','wordcloud','ggbiplot','factoextra','plotly','rsconnect'))
library(plyr)
library(dplyr)
library(shiny)
library(bitops)
library(httr)
library(RCurl)
library(XML)
library(tm)
library(NLP)
#library(tmcn)
library(jiebaRD)
library(jiebaR)
library(rvest)
library(magrittr)
library(ggplot2)
library(tidytext)
library(stats)
library(proxy)
library(readtext)
library(slam)
library(Matrix)
library(tidyverse)
library(wordcloud)
library(ggbiplot)
library(factoextra)
library(plotly)
library(rsconnect)
#
# This is a Shiny web application. You can run the application by clicking
# the 'Run App' button above.
#
# Find out more about building applications with Shiny here:
#
#    http://shiny.rstudio.com/
#
#-------------------Program---------------------------
# è¼‰å…¥å¥—ä»¶åŒ…
setwd("D:/CSX_Lyhs/week_6/hw_678/shinylyrics/")
source('global.R', local = TRUE)
##è³‡æ–™å‰è™•ç†
#å»ºç«‹çµæ§‹èˆ‡æ¸…æ´—
dir = DirSource("./lyrics/", encoding = "BIG-5")
corpus = Corpus(dir)
runApp()
runApp()
corpus <- tm_map(corpus, removePunctuation)
corpus <- tm_map(corpus, removeNumbers)
corpus <- tm_map(corpus, function(word) {
gsub("[A-Za-z0-9]", "", word) })
corpus <- tm_map(corpus, function(word) {
gsub("å¦³", "ä½ ", word) })
corpus <- tm_map(corpus, function(word) {
gsub("\n", "", word) })
#æ–·è©
mixseg = worker()
new_user_word(mixseg,'ç‚ºäº†',"n")
new_user_word(mixseg,'å†ä¹Ÿ',"n")
new_user_word(mixseg,'è®“äºº',"n")
new_user_word(mixseg,'æƒ³åƒ',"n")
new_user_word(mixseg,'ä¹Ÿä¸',"n")
new_user_word(mixseg,'é€™æ˜¯',"n")
new_user_word(mixseg,'å†é€™æ¨£',"n")
jieba_tokenizer = function(d){
unlist(segment(d[[1]], mixseg))
}
seg = lapply(corpus, jieba_tokenizer)
#è©é »å‘é‡
count_token = function(d){
as.data.frame(table(d))
}
tokens = lapply(seg, count_token)
#è©é »çŸ©é™£TDM
n_tag = length(seg)
TDM = tokens[[1]]
tagNames <- list.files('./')
tagNames <- gsub(".txt", "", tagNames) #å–ä»£
for( id in c(2:n_tag) ){
TDM = merge(TDM, tokens[[id]], by="d", all = TRUE)
names(TDM) = c('d', tagNames[1:id])
}
n_tag
TDM = tokens[[1]]
tagNames <- list.files('./lyrics/')
tagNames <- gsub(".txt", "", tagNames) #å–ä»£
for( id in c(2:n_tag) ){
TDM = merge(TDM, tokens[[id]], by="d", all = TRUE)
names(TDM) = c('d', tagNames[1:id])
}
TDM[is.na(TDM)] <- 0 #å°‡NAå¡«0
runApp()
runApp()
runApp()
install.packages("mclust")
shiny::runApp()
shiny::runApp()
shiny::runApp()
tryCatch({
stop('')
},error=function(err){
traceback()
})
tryCatch({
# some other code
}, warning = function(war){
logwarn(war, logger = "MyLogger")
}, error = function(err){
# edit the error message
err$message <- paste("While training model", err, sep = " ")
# and re-raise
stop(err)
})
tryCatch({
stop('')
},error=function(err){
traceback()
})
runApp()
runApp()
options(encoding = "UTF-8")
deployApp(...)
options(encoding = "UTF-8")
deployApp(shinylyrics)
options(encoding = "UTF-8")
deployApp('shinylyrics')
options(encoding = "UTF-8")
deployApp('shinylyrics.R')
deployApp('./')
deployApp('D:\CSX_Lyhs\week_6\hw_678\shinylyrics')
deployApp('shinylyrics.Rproj')
deployApp()
options(encoding = "UTF-8")
deployApp()
options(encoding = "UTF-8")
deployApp()
rsconnect::appDependencies()
install.packages("mclust")
#-------------------Program---------------------------
# è¼‰å…¥å¥—ä»¶åŒ…
source('global.R')
runApp()
runApp()
runApp()
##è³‡æ–™å‰è™•ç†
#å»ºç«‹çµæ§‹èˆ‡æ¸…æ´—
dir = DirSource("lyrics/", encoding = "BIG-5")
#-------------------Program---------------------------
# è¼‰å…¥å¥—ä»¶åŒ…
source('global.R', local = TRUE)
corpus = Corpus(dir)
corpus
dir
runApp()
runApp()
runApp()
library(plyr)
library(dplyr)
library(shiny)
library(bitops)
library(httr)
library(RCurl)
library(XML)
library(tm)
library(NLP)
library(tmcn)
library(jiebaRD)
library(jiebaR)
library(rvest)
library(magrittr)
library(ggplot2)
library(tidytext)
library(stats)
library(proxy)
library(slam)
library(Matrix)
library(readtext)
library(wordcloud)
library(tidyverse)
library(ggbiplot)
library(factoextra)
library(plotly)
library(rsconnect)
#-------------------Program---------------------------
# è¼‰å…¥å¥—ä»¶åŒ…
source('global.R', local = TRUE)
runApp()
dir
runApp()
shiny::runApp()
runApp()
